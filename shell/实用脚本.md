# linux/mac 实用脚本

## 知识

`set -ex`:
 `-e`:命令失败后立即结束
 `-x`:打印每条执行的命令

## mysqldump

[MySQL mysqldump数据导出详解](https://www.cnblogs.com/chenmh/p/5300370.html)
复制表，调用方式:`sh copy.sh "-h127.0.0.0 -uroot -P8306 -p123456 boss_develop"`

```bash
#!/bin/bash
#set -x
REMOTE_HOST=$1
echo REMOTE_HOST:$REMOTE_HOST


oldifs=$IFS
dump(){
# -C启用压缩
mysqldump -h10.69.34.205 -uadmin -P9800 -pDc@20120225 --opt -C boss $1 | mysql $REMOTE_HOST
}
dtd(){
        IFS=$oldifs
        arr=($1)
        for table in ${arr[@]}
        do
	    echo start dump $table
            dump $table
        done
        IFS=$'\n'
}

IFS=$'\n'

#crm_measurement_units  crm_department crm_role_extend crm_price_item_ref_measure_time crm_time_units
#crm_special_rules_item crm_special_rules_product_item_rel crm_special_rules_product_type_rel
#dw_manual_rule dw_slice_rule
#crm_account_director crm_employee crm_region_base

tables="
crm_product_type crm_product_line_group
crm_account crm_contract contract_account_release crm_product_type_relation contract_product_price
crm_price_definition crm_price_detail
crm_special_rules_discount crm_contract_sprules crm_contract_sprules_regions
crm_rule_use_log crm_rule_use_lock crm_manual_rule crm_manual_rule_lock
month_bill_locked month_bill_summary_new
"

for table in ${tables[@]}
do
        read -r -p $table" ? [Y/n] " input
        case $input in
                [yY][eE][sS]|[yY]) dtd "${table}" ;;
                *) echo "No";;
        esac
done

IFS=$oldifs

echo finish copy
read
```
